<!DOCTYPE html>
<html>
<head>
    <title>SEEK video manager</title>

    <link href="/static/style.css" rel="stylesheet" type="text/css" />
    <link href="/static/jquery.modal.css" rel="stylesheet" type="text/css" />

    <script src="/static/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="/static/jquery.cookie.js" type="text/javascript"></script>
    <script src="/static/jquery.modal.min.js" type="text/javascript"></script>
    <script src="/static/knockout-2.3.0.js" type="text/javascript"></script>
</head>
<body>
    <div id="container">
        <!-- HEADER - contains logo and account management -->
        <div id="header">
            <span id="logo"><b>SEEK.</b>CHAPTERHOUSE<b>.</b>IO</span>
            {% if user.id %}
                <span id="greet">HI {{ user.username.upper }}</span>
                <form id="logoutForm" action="/account/log_out" method="post">
                    {% csrf_token %}
                    <input type="submit" id="logout" value="Log Out" />
                </form>
            {% else %}
                <button id="register" data-bind="click: register">Register</button>
                <form id="registerModal" action="/account/register" method="post" style="display: none;">
                    {% csrf_token %}
                    <label for="username">Username</label>
                    <input id="username" name="username" type="text"><br/>
                    <label for="email">Email</label>
                    <input id="email" name="email" type="text"><br/>
                    <label for="password">Password</label>
                    <input id="password" name="password" type="password"><br/>
                    <label for="repassword">Re-enter Password</label>
                    <input id="repassword" name="repassword" type="password"><br/>
                    <input type="submit" value="Register">
                </form>
                <button id="login" data-bind="click: login">Log In</button>
                <form id="loginModal" action="/account/log_in" method="post" style="display: none;">
                    {% csrf_token %}
                    <label for="username">Username</label>
                    <input id="username" name="username" type="text"><br/>
                    <label for="password">Password</label>
                    <input id="password" name="password" type="password"><br/>
                    <input type="submit" value="Log In">
                </form>
            {% endif %}
        </div>

        <!-- VIDEOS - for selecting a video -->
        <div id="videos">
            <button data-bind="click: openVideoModal">Add a video</button>
            <div id="videolist" data-bind="foreach: videos">
                <img data-bind="attr: { src: getThumbnailUrl() }, click: model.player.loadVideo">
            </div>
            <form id="addVideoModal" style="display:none;">
                <label for="youtubeUrl">YouTube Video URL</label>
                <!-- TODO add jquery watermark -->
                <input id="youtubeUrl" type="text"
                       data-bind="event: { keypress: addVideo }" >
            </form>
        </div>

        <!-- CONTENT - the player and timestamps -->
        <div id="content">
            <div id='player'></div>
            <form id='controls'>
                <button data-bind="click: player.seekDiff" value="-30">&lt; 30</button>
                <button data-bind="click: player.seekDiff" value="-5">&lt; 5</button>
                <button data-bind="click: player.playPause">&gt;</button>
                <button data-bind="click: player.seekDiff" value="5">5 &gt;</button>
                <button data-bind="click: player.seekDiff" value="30">30 &gt;</button>

                <button data-bind="click: player.addTimestamp">Add timestamp</button>

                <!-- TODO - audio gets screwed up, re-enable this if Youtube improves HTML5 player
                <label for="playbackRates">Playback Rate</label>
                <select id="playbackRates" data-bind="options: player.playbackRates, event: { change: player.setPlaybackRate }">
                </select>
                -->

                <button data-bind="click: deleteVideo">Delete video</button>
            </form>
            <!-- ko if: player.currentVideo -->
            <table id="timestamps" data-bind="foreach: player.currentVideo().timestamps">
                <tr>
                    <td class="time">
                        <button data-bind="text: getDisplay(), click: $parent.player.seek" />
                    </td>
                    <td class="name" data-bind="text: name"></td>
                    <td class="loop">
                        <button data-bind="click: $parent.player.setStartPoint,
                                           visible: $parent.player.showStartPoint($data)">Start</button>
                        <button data-bind="click: $parent.player.setEndPoint,
                                           visible: $parent.player.showEndPoint($data, $index())">End</button>
                    </td>
                    <td class="delete">
                        <button data-bind="click: $parent.player.deleteTimestamp">X</button>
                    </td>
                </tr>
            </table>
            <!-- /ko -->
        </div>

        <!-- FOOTER - copyright and technologies -->
        <div id="footer">
            <span id="copy">
                &copy; 2013
                <a href="http://chapterhouse.io">Alex Gallichotte</a>
            </span>
            <span id="tech">
                <a target="blank" href="https://djangoproject.com/">Django</a>
                <a target="blank" href="http://knockoutjs.com/">KnockoutJS</a>
                <a target="blank" href="http://jquery.com/">jQuery</a>
                <a target="blank" href="https://developers.google.com/youtube/iframe_api_reference">YouTube API</a>
                <a target="blank" href="https://heroku.com/">Heroku</a>
            </span>
        </div>
    </div>
</body>
<script src="/static/api.js" type="text/javascript"></script>
<script src="/static/models.js" type="text/javascript"></script>
<script src="/static/code.js" type="text/javascript"></script>
</html>